/*
 *  MLToolKit
 *
 *  Created by Hong Lu on 07/11/2011.
 *
 */

package edu.dartmouth.cs.mltoolkit.processing;

import java.util.*;

import android.util.Log;

import edu.emory.mathcs.jtransforms.fft.*;

import java.math.*;


/**
 * @author hong
 *
 *  audio feature extraction 
 *  reference: The Jigsaw continuous sensing engine for mobile phone applications, Sensys 2010  
 *
 */

public class AudioFeatureExtraction {
	private static final String TAG = "mltoolkit";
	private int fft_length = 0;
	private int frame_length = 0;
	private int window_length = 0;
	private int mfcc_length = 0;
	private int mfcc_bank = 0;
	private int frameIndex = 0;
	private final int id;

	final int frame_feature_size = 50;
	final int window_feature_size = 25;
	final double[] hamming = new double[]{0.080000000000000015543,0.080139632090179102608,0.080558443590626638287,0.081256180242537501268,0.082232418452750366544,0.08348656555090955278,0.085017860149272872494,0.08682537260494699316,0.088908005584270255461,0.091264494728999168149,0.093893409423895624055,0.096793153665247821937,0.099961967029797205164,0.10339792574348544152,0.10709894384936913259,0.11106277447399631741,0.1152870111914748863,0.11976908948440362357,0.12450628830078075415,0.12949573170594402827,0.13473439062853914683,0.14021908469945698616,0.14594648418262318179,0.15191311199646745367,0.15811534582484670919,0.16454942031613800646,0.1712114293691693323,0.17809732850459775166,0.18520293732029685652,0.19252394202926287337,0.20005589807849682993,0.20779423284727571719,0.21573424842317234784,0.22387112445413920314,0.2321999210749252085,0.24071558190604869232,0.24941293712350454115,0.25828670659734503934,0.26733150309722475413,0.27654183556296763058,0.28591211243816733178,0.29543664506479938581,0.30510965113678278904,0.31492525821039518696,0.32487750726941011514,0.33496035634279242021,0.34516768417275478509,0.35549329393094941665,0.36593091698053725747,0.37647421668185376831,0.38711679223935657745,0.39785218258752419462,0.40867387031334262426,0.41957528561300150294,0.43054981028039535085,0.44159078172501126103,0.45269149701676009157,0.46384521695530023244,0.47504517016137792762,0.48628455718770613458,0.49755655464688108847,0.50885431935383451663,0.52017099248030396197,0.53149970371880028708,0.54283357545354382623,0.55416572693583832088,0.5654892784613462231,0.57679735554672917353,0.58808309310312056883,0.59933963960389347037,0.61056016124419532076,0.62173784608972360033,0.6328659082122246593,0.64393759180920384644,0.65494617530534626759,0.66588497543315816607,0.67674735129035323844,0.68752670837151730332,0.69821650257160694508,0.70881024415884918977,0.7193015017146324741,0.7296839060379955999,0.73995115401234390351,0.75009701243204673915,0.76011532178659180214,0.76999999999999990674,0.77974504612322925734,0.78934454397732678466,0.79879266574511875731,0.8080836755092539736,0.81721193273445802419,0.82617189569187798881,0.83495812482344600181,0.84356528604421232576,0.8519881539806477555,0.86022161514294626095,0.86826067102940607256,0.87610044116099883293,0.88373616604428995025,0.89116321006090748469,0.89837706428180852392,0.9053733492046316389,0.91214781741247574764,0.91869635615249012339,0.9250149898327097997,0.93109988243562247234,0.93694733984699929419,0.94255381209857669322,0.94791589552322852441,0.95303033482131871423,0.95789402503698095614,0.96250401344312463969,0.96685750133402437179,0.97095184572440285109,0.97478456095397703063,0.97835332019649201563,0.98165595687232898303,0.9846904659638262558,0.98745500523251827918,0.98994789633755064795,0.99216762585459483681,0.99411284619464179713,0.99578237642211786529,0.9971752029718259358,0.99829048026427757989,0.99912753121904041009,0.99968584766579060563,0.99996509065282213058,0.99996509065282213058,0.99968584766579060563,0.99912753121904041009,0.99829048026427757989,0.9971752029718259358,0.99578237642211786529,0.99411284619464179713,0.99216762585459483681,0.98994789633755064795,0.98745500523251827918,0.9846904659638262558,0.98165595687232898303,0.97835332019649201563,0.97478456095397703063,0.97095184572440285109,0.96685750133402437179,0.96250401344312463969,0.95789402503698095614,0.95303033482131871423,0.94791589552322852441,0.94255381209857669322,0.93694733984699929419,0.93109988243562247234,0.9250149898327097997,0.91869635615249012339,0.91214781741247574764,0.9053733492046316389,0.89837706428180852392,0.89116321006090748469,0.88373616604428995025,0.87610044116099883293,0.86826067102940607256,0.86022161514294626095,0.8519881539806477555,0.84356528604421232576,0.83495812482344600181,0.82617189569187798881,0.81721193273445802419,0.8080836755092539736,0.79879266574511875731,0.78934454397732678466,0.77974504612322925734,0.76999999999999990674,0.76011532178659180214,0.75009701243204673915,0.73995115401234390351,0.7296839060379955999,0.7193015017146324741,0.70881024415884918977,0.69821650257160694508,0.68752670837151730332,0.67674735129035323844,0.66588497543315816607,0.65494617530534626759,0.64393759180920384644,0.6328659082122246593,0.62173784608972360033,0.61056016124419532076,0.59933963960389347037,0.58808309310312056883,0.57679735554672917353,0.5654892784613462231,0.55416572693583832088,0.54283357545354382623,0.53149970371880028708,0.52017099248030396197,0.50885431935383451663,0.49755655464688108847,0.48628455718770613458,0.47504517016137792762,0.46384521695530023244,0.45269149701676009157,0.44159078172501126103,0.43054981028039535085,0.41957528561300150294,0.40867387031334262426,0.39785218258752419462,0.38711679223935657745,0.37647421668185376831,0.36593091698053725747,0.35549329393094941665,0.34516768417275478509,0.33496035634279242021,0.32487750726941011514,0.31492525821039518696,0.30510965113678278904,0.29543664506479938581,0.28591211243816733178,0.27654183556296763058,0.26733150309722475413,0.25828670659734503934,0.24941293712350454115,0.24071558190604869232,0.2321999210749252085,0.22387112445413920314,0.21573424842317234784,0.20779423284727571719,0.20005589807849682993,0.19252394202926287337,0.18520293732029685652,0.17809732850459775166,0.1712114293691693323,0.16454942031613800646,0.15811534582484670919,0.15191311199646745367,0.14594648418262318179,0.14021908469945698616,0.13473439062853914683,0.12949573170594402827,0.12450628830078075415,0.11976908948440362357,0.1152870111914748863,0.11106277447399631741,0.10709894384936913259,0.10339792574348544152,0.099961967029797205164,0.096793153665247821937,0.093893409423895624055,0.091264494728999168149,0.088908005584270255461,0.08682537260494699316,0.085017860149272872494,0.08348656555090955278,0.082232418452750366544,0.081256180242537501268,0.080558443590626638287,0.080139632090179102608,0.080000000000000015543,};
	final double[][] filter = new double[][]{{0.025623132619010235284,0.026462116396657787282,0.027259122867893455233,0.028011845255665267229,0.028718094304613858009,0.029375806708728673805,0.029983053088234620093,0.030538045477831905761,0.031039144290596305115,0.031484864724232432265,0.031873882578945002264,0.032205039458939418995,0.032477347332468403662,0.032689992428388325862,0.032842338450362211499,0.032933929093126861065,0.032964489848610445399,0.032933929093126861065,0.03284233845036220456,0.032689992428388325862,0.032477347332468403662,0.032205039458939412056,0.031873882578945009203,0.031484864724232439204,0.031039144290596305115,0.0305380454778319127,0.029983053088234620093,0.029375806708728666866,0.028718094304613858009,0.028011845255665274168,0.027259122867893444825,0.026462116396657780343,0.025623132619010238753,},
			{-0.018825257122592427284,-0.01194257265444412415,-0.0048247338577421970338,0.0024244347508766950737,0.0096982002527664593755,0.016888614330027050536,0.023888239312527877189,0.030591877755108288356,0.036898275768051352896,0.042711770606102587855,0.047943853846436318422,0.052514622841451093216,0.056354094995113943045,0.059403361748816642385,0.061615561932041915116,0.062956657283712413875,0.06340599642349215026,0.062956657283712413875,0.061615561932041901239,0.059403361748816642385,0.056354094995113949984,0.052514622841451086277,0.0479438538464363323,0.042711770606102587855,0.036898275768051359835,0.030591877755108288356,0.023888239312527887598,0.016888614330027050536,0.0096982002527664507019,0.0024244347508766911706,-0.0048247338577421909622,-0.011942572654444120681,-0.018825257122592434222,},
			{-0.058387518249997071018,-0.057543671664752112094,-0.054451126969077216777,-0.0492118949592042082,-0.042015077758697748356,-0.033129881602450603206,-0.022895261310282331163,-0.011706605446401781995,1.0092936587501423375e-17,0.011765285050394650584,0.023125362511886370098,0.033630575643819583809,0.042863838630751785463,0.050457700011331999002,0.056109410664164235949,0.059593360492711702769,0.060770358072951662087,0.059593360492711709708,0.056109410664164235949,0.05045770001133200594,0.042863838630751785463,0.03363057564381957687,0.023125362511886377037,0.011765285050394643646,4.2053902447922597395e-18,-0.011706605446401768117,-0.022895261310282331163,-0.033129881602450610145,-0.042015077758697748356,-0.0492118949592042082,-0.054451126969077223716,-0.057543671664752112094,-0.058387518249997064079,},
			{-0.021850032160724269098,-0.03947410562857928823,-0.054273364188545988873,-0.06509201711017613412,-0.071070569732718733014,-0.071714967048330954813,-0.066937731532433861203,-0.057067640513936729318,-0.042826958854104028862,-0.025277809175444608536,-0.005741718383726158309,0.014301472603296602748,0.03332748367611159529,0.049885356447995424234,0.062709862465658350317,0.070819715366540803014,0.07359384533310875387,0.070819715366540789137,0.062709862465658378072,0.049885356447995445051,0.03332748367611159529,0.014301472603296616626,-0.0057417183837261383597,-0.025277809175444608536,-0.042826958854104035801,-0.05706764051393672238,-0.066937731532433861203,-0.071714967048330940935,-0.071070569732718746891,-0.06509201711017613412,-0.054273364188545968056,-0.039474105628579302107,-0.021850032160724282976,},
			{0.051059147497737038257,0.035269577415814004628,0.01490142139537622111,-0.0075411130371602777892,-0.029265696559168684343,-0.047543094286130266335,-0.060053764090994839198,-0.065185349807551432044,-0.06224251462735736623,-0.051541540774722394147,-0.034376760835629717461,-0.012862304100401785595,0.010331287999012875659,0.032312393673301895158,0.050333003645304144613,0.062136255351583555284,0.066242355603126648611,0.062136255351583555284,0.050333003645304158491,0.032312393673301922914,0.010331287999012879128,-0.012862304100401785595,-0.034376760835629696644,-0.051541540774722387208,-0.06224251462735736623,-0.065185349807551432044,-0.060053764090994839198,-0.047543094286130266335,-0.029265696559168694751,-0.0075411130371602751871,0.014901421395376219375,0.035269577415814004628,0.051059147497737038257,},
			{0.042458994884887517329,0.060915081783292308881,0.067507293888240699209,0.06076375961461402686,0.04186780041052572815,0.014451962699572747442,-0.016105354716017327571,-0.043743523055531564891,-0.062931546299847346271,-0.06978389007711294223,-0.062853368005489282377,-0.043438049903919036254,-0.015336807579543336108,0.015900236893401864524,0.044077240919476207148,0.063592084197573089943,0.070559690459212134894,0.063592084197573062188,0.044077240919476234904,0.015900236893401871463,-0.015336807579543341312,-0.043438049903919050132,-0.062853368005489282377,-0.069783890077112928352,-0.062931546299847374026,-0.043743523055531564891,-0.016105354716017317163,0.014451962699572738769,0.041867800410525721211,0.06076375961461402686,0.067507293888240713087,0.060915081783292308881,0.042458994884887489574,},
			{-0.048501858493741965839,-0.023161329202901512897,0.0095524184352664930076,0.039986775578915355334,0.059006976474546432576,0.060755781826244095734,0.044466623848614217351,0.014765952224824477335,-0.01964805726582840098,-0.048571085199806837696,-0.06334046588758850127,-0.059448335846649283387,-0.037926264135362222629,-0.0050733601960569587111,0.029401140476932492718,0.05526907637131566603,0.064840958037576959527,0.055269076371315679908,0.029401140476932492718,-0.0050733601960569483028,-0.037926264135362222629,-0.059448335846649269509,-0.06334046588758850127,-0.04857108519980687239,-0.019648057265828411388,0.014765952224824456518,0.04446662384861422429,0.060755781826244081856,0.059006976474546439515,0.039986775578915369211,0.009552418435266515559,-0.023161329202901499019,-0.048501858493741979717,},
			{-0.033013916218079628062,-0.069843585313939235415,-0.077787876551544538062,-0.052869125709404683755,-0.0050641543195767109789,0.045700954989872887013,0.077899948994395659674,0.07758296821796548115,0.044447958113972452221,-0.007847757991491141269,-0.057346354138678966306,-0.083061907212298544123,-0.073928556939851883256,-0.03358745816431649156,0.021069120734334655792,0.067012933693889178977,0.084839678316530775515,0.067012933693889165099,0.021069120734334659262,-0.033587458164316512377,-0.073928556939851869378,-0.083061907212298558001,-0.05734635413867893855,-0.0078477579914911499426,0.04444795811397245916,0.07758296821796548115,0.077899948994395673552,0.045700954989872887013,-0.0050641543195767248567,-0.052869125709404669877,-0.077787876551544538062,-0.069843585313939207659,-0.03301391621807964194,},
			{0.057246221189730113477,0.040984258114743897516,-1.8924256101565166902e-17,-0.041912664832295859485,-0.059869167208049661744,-0.042725163019885804838,1.3457248783335231167e-17,0.04341426373315771664,0.061815963170350429756,0.04397353802849476162,-1.0092936587501423375e-17,-0.044397716793954614123,-0.063014296853999604564,-0.044682773389549290677,0,0.044825987284418486456,0.063418881644212068971,0.044825987284418479517,1.6821560979169038958e-17,-0.044682773389549290677,-0.063014296853999604564,-0.044397716793954628001,-2.018587317500284675e-17,0.043973538028494747743,0.061815963170350429756,0.043414263733157737457,3.3643121958338077916e-17,-0.042725163019885804838,-0.059869167208049654805,-0.041912664832295873363,-3.7007434154171882626e-17,0.040984258114743897516,0.057246221189730106538,},
			{-0.031598406914269558388,0.020771019266458176644,0.058304592740049628052,0.050392805031236352631,0.0019731302085805213671,-0.049350439470928826602,-0.062616310711491207641,-0.026318488527739804239,0.03165919646197782461,0.065538400560016682461,0.047944061496102530207,-0.0078959560558401614694,-0.058117427705826174567,-0.062829080646010476707,-0.017937753148188337327,0.041311339313547898455,0.068132273826309541764,0.041311339313547884577,-0.017937753148188323449,-0.062829080646010476707,-0.058117427705826160689,-0.0078959560558401545305,0.047944061496102537145,0.065538400560016682461,0.03165919646197782461,-0.02631848852773980077,-0.062616310711491193763,-0.049350439470928826602,0.0019731302085805161629,0.050392805031236345692,0.05830459274004964193,0.020771019266458180114,-0.03159840691426954451,},
			{-0.0042694357322405809135,-0.063082321028612470259,-0.056669650075736925643,0.010733519038445821572,0.069107896256820039449,0.05558664709063250442,-0.017674437457902862636,-0.074146908468587735541,-0.053129643617481757401,0.024817870422799561542,0.077946597779086357338,0.049358404085625501301,-0.031860318590453462484,-0.0803100439063143684,-0.044409851515542442257,0.038490094829251683684,0.081112157004986723541,0.038490094829251697561,-0.044409851515542435318,-0.0803100439063143684,-0.031860318590453469423,0.04935840408562550824,0.077946597779086357338,0.024817870422799582358,-0.053129643617481771278,-0.074146908468587749419,-0.0176744374579029008,0.05558664709063250442,0.069107896256820039449,0.010733519038445828511,-0.056669650075736939521,-0.063082321028612470259,-0.0042694357322405999955,},
			{0.021562174341335269001,0.071750842539855044788,0.022758543006262628439,-0.061048232092658083481,-0.062437386699605475215,0.024347777972460061396,0.080294377296469127137,0.025240266384213547179,-0.067098671286109953793,-0.068010645322655480238,0.026283479651113616365,0.085901354507333438359,0.026760865871458379417,-0.070503633097351414705,-0.070821614367554214242,0.027124587155389363186,0.087856042763919992011,0.027124587155389373594,-0.07082161436755422812,-0.070503633097351386949,0.02676086587145836207,0.085901354507333438359,0.026283479651113599018,-0.06801064532265546636,-0.067098671286109967671,0.025240266384213564527,0.080294377296469099381,0.024347777972460071805,-0.062437386699605461338,-0.061048232092658055725,0.0227585430062626215,0.071750842539855017033,0.021562174341335269001,},
			{-0.019359739674071268362,-0.063823912176258018603,0.0052903096401133832896,0.069641341612597690292,0.011241772529089321536,-0.07114086455457027669,-0.029023546878756068673,0.067730218512682946463,0.046588839922530593529,-0.059283005517959778963,-0.062374205576139589435,0.046190280398724456457,0.074899791856966713155,-0.029345857499627689413,-0.082949805380626337459,0.010063660054208745445,0.085725869465194740049,0.010063660054208750649,-0.082949805380626351337,-0.029345857499627665127,0.074899791856966713155,0.04619028039872449809,-0.062374205576139617191,-0.059283005517959778963,0.046588839922530572712,0.067730218512682918708,-0.029023546878756061734,-0.071140864554570290568,0.011241772529089340618,0.069641341612597690292,0.0052903096401133980348,-0.063823912176257990847,-0.019359739674071282239,},
			{-0.014760044100379902249,0.04922891189067079426,0.0041251605864921882597,-0.054855998986880677437,0.0089384724006783752848,0.057054964411900832566,-0.023460910041911729046,-0.055140562744369583936,0.038171501289200389373,0.048846164126784684389,-0.051644308173656887362,-0.038402500198197034309,0.062482047994873488039,0.024544911619032949018,-0.069509528384860505557,-0.0084425474431023047467,0.071943624022056951173,-0.0084425474431022804606,-0.069509528384860533312,0.024544911619032980243,0.062482047994873488039,-0.038402500198197020431,-0.051644308173656852667,0.048846164126784663573,0.03817150128920041019,-0.055140562744369590875,-0.023460910041911749863,0.057054964411900839505,0.0089384724006783405903,-0.054855998986880663559,0.004125160586492179586,0.049228911890670773444,-0.01476004410037989184,},
			{0.046263679651678379923,-0.018986985438623926736,-0.037455688946038234732,0.052012150490620641385,-1.6485129759585657871e-16,-0.057961404800215179933,0.046514244834047917265,0.026275941996261976269,-0.071347135537294464891,0.028243229567680407793,0.053740053901808491899,-0.071979211961277447807,1.3457248783335231167e-17,0.074625133045659014508,-0.057763587678196885722,-0.03147374693020878883,0.08243063868269566441,-0.031473746930208761075,-0.057763587678196892661,0.074625133045659028386,3.7007434154171882626e-17,-0.071979211961277475562,0.053740053901808505776,0.028243229567680425141,-0.071347135537294478769,0.026275941996261986677,0.046514244834047896449,-0.057961404800215172994,-1.5139404881252133522e-16,0.052012150490620627508,-0.037455688946038213916,-0.018986985438623926736,0.046263679651678372984,},
			{0.010798380141032785928,-0.035611459678804698037,0.037644820021203555249,-0.01074264529727417955,-0.029275076615531379909,0.053400288661056796724,-0.040478675366296359983,-0.0047697229217455502231,0.051900051686559339759,-0.065411436203793416055,0.03182238219183222,0.027774168556813409736,-0.071019064255351135873,0.065095857309085292108,-0.012133628117997986851,-0.050853993067568430131,0.078551553487519909513,-0.050853993067568430131,-0.012133628117997983381,0.065095857309085292108,-0.071019064255351135873,0.027774168556813406267,0.03182238219183222,-0.065411436203793416055,0.051900051686559339759,-0.0047697229217455432843,-0.040478675366296353044,0.053400288661056810602,-0.029275076615531383378,-0.010742645297274189958,0.037644820021203562188,-0.035611459678804698037,0.010798380141032791132,},
			{0.007976217651313883758,-0.021131676558276815681,0.032597489827910511306,-0.038461055656338054287,0.035454953338752814851,-0.022180871134834065361,-3.8689590252088791145e-17,0.026797075457504503093,-0.051748113153845087808,0.067818409724363273861,-0.069441542690074617439,0.054384852772393611764,-0.024799892551637742893,-0.012976839001724169848,0.049925078976557006605,-0.076760734084691112367,0.086558745848834758863,-0.076760734084691112367,0.049925078976556985788,-0.012976839001724147296,-0.024799892551637760241,0.054384852772393611764,-0.069441542690074631317,0.067818409724363273861,-0.051748113153845080869,0.026797075457504492685,-3.0278809762504267043e-17,-0.022180871134834068831,0.035454953338752814851,-0.038461055656338054287,0.032597489827910497429,-0.021131676558276815681,0.0079762176513138802886,}};
	final int[][] filterInd = new int[][]{{2,7},{5,10},{8,13},{11,16},{14,19},{17,22},{20,25},{23,28},{26,31},{29,34},{32,37},
			{35,41},{38,45},{42,49},{46,54},{50,60},{55,66},{61,72},{67,79},{73,87},{80,96},{88,106},{97,117},{107,128}};
	final double[][] bankFilter = new double[][]{
			{0,0.0035540369188138774131,0.0071080738376277548263,0.010662110756441632239,0.0071126292612726680839,0.0035585923424587911044,4.5554236449135278338e-06,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0.0035517592069914216517,0.0071057961258052994985,0.010659833044619176912,0.007114906973095124279,0.0035608700542812438301,6.833135467363831854e-06,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0.0035494814951689663239,0.0071035184139828450381,0.010657555332796725053,0.0071171846849175778721,0.0035631477661037021937,9.1108472898270505855e-06,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0.0035472037833465105625,0.0071012407021603845061,0.010655277620974259317,0.0071194623967400366693,0.0035654254779261605572,1.138855911228381662e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0.0035449260715240521989,0.0070989629903379309131,0.010652999909151810928,0.0071217401085624954665,0.0035677031897486115482,1.3666270934727678955e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0035426483597015973048,0.0070966852785154781874,0.010650722197329357335,0.0071240178203849438554,0.0035699809015710738148,1.5943982757203777669e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0035403706478791415434,0.0070944075666930107166,0.010648444485506879456,0.0071262955322074095915,0.003572258613393531311,1.8221694579654111335e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0035380929360566779757,0.0070921298548705588582,0.010646166773684439741,0.0071285732440298675214,0.0035745363252159857714,2.0499406402104434837e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0035358152242342256837,0.0070898521430481061326,0.010643889061861984413,0.0071308509558523185123,0.0035768140370384428339,2.2777118224567626464e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0035051902230167865035,0.0070307153989372607114,0.010556240574857734052,0.0071316603898865316494,0.0036622510559946482023,0.00019284172210276494491,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0032558071995196016801,0.0065326148095690324269,0.0098094224196184614389,0.0071800151382823470397,0.0042029987776567414096,0.0012259824170311353457,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0025533086068624203518,0.0052568916738139773517,0.0079604747407655343516,0.0076302241583084233489,0.0051758418741338109437,0.002721459589959197671,0.00026707730578458461525,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0013105634168706877581,0.0035387148173240731003,0.0057668662177774582256,0.0079950176182308433509,0.0064348151985020524482,0.0044120420162828298191,0.0023892688340636067564,0.00036649565184438396464,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0016365030191621704209,0.003472828569514243343,0.0053091541198663156145,0.0071454796702183891871,0.0061131767615908274086,0.0044461131696282947187,0.0027790495776657620289,0.001111985985703229339,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0012391976454165960775,0.0027526008756413125091,0.0042660041058660280733,0.0057794073360907440712,0.0063314309731881185037,0.0049575245737578151756,0.0035836181743275105464,0.0022097117748972067847,0.00083580537546690258921,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.00041529927810125512799,0.0016625668646223091662,0.0029098344511433631501,0.0041571020376644169173,0.0054043696241854706844,0.0057196606048304865846,0.0045873589916848407297,0.0034550573785391948747,0.0023227557653935485861,0.0011904541522479022975,5.8152539102256259557e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0004025976985516386609,0.0014305302424481350886,0.0024584627863446311367,0.0034863953302411276186,0.0045143278741376236668,0.0055422604180341205823,0.0047097954461289455452,0.0037766118292072536726,0.0028434282122855613663,0.0019102445953638688431,0.00097706097844217675366,4.3877361520484535441e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.00080365939824090419988,0.0016508275009162658251,0.0024979956035916274504,0.0033451637062669888588,0.0041923318089423502672,0.0050394999116177121093,0.0043464133249626214078,0.0035773323197066130875,0.0028082513144506043336,0.002039170309194596447,0.0012700893039385881267,0.00050100829868257969798,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.00066536326040601021046,0.0013635547890739048525,0.0020617463177417996029,0.0027599378464096941364,0.0034581293750775891037,0.0041563209037454836373,0.0043902176623344824763,0.0037563814248352304058,0.0031225451873359792027,0.0024887089498367271322,0.0018548727123374757122,0.0012210364748382240754,0.00058720023733897243855,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.00020056727250961507215,0.00077598012051955874997,0.0013513929685295023465,0.0019268058165394460514,0.0025022186645493899732,0.0030776315125593334612,0.0036530443605692769493,0.0041476849015115281952,0.0036253103099904704365,0.0031029357184694122442,0.0025805611269483544855,0.0020581865354272958595,0.0015358119439062381008,0.0010134373523851799084,0.0004910627608641218245,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3.4892233052987712725e-05,0.00050911733040791468975,0.00098334242776284153803,0.0014575675251177686031,0.0019317926224726956683,0.0024060177198276222997,0.0028802428171825493648,0.0033544679145374764299,0.0037744617572397424869,0.0033439480098033432659,0.0029134342623669431775,0.0024829205149305439565,0.0020524067674941443018,0.0016218930200577446471,0.0011913792726213449924,0.00076086552518494555454,0.00033035177774854589984,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.3426959620092731442e-05,0.00041425841870041177481,0.00080508987778073074024,0.0011959213368610498683,0.001586752795941368888,0.0019775842550216879076,0.0023684157141020071441,0.0027592471731823259469,0.0031500786322626447497,0.0033674322342298473876,0.0030126253777323854129,0.0026578185212349230045,0.0023030116647374601624,0.0019482048082399981877,0.0015933979517425357793,0.0012385910952450733709,0.00088378423874761085407,0.00052897738225014866251,0.00017417052575268622701,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7.4939419705455850374e-05,0.00039704221489456970658,0.00071914501008368348148,0.0010412478052727973648,0.0013633506004619110313,0.0016854533956510251314,0.0020075561908401385811,0.0023296589860292526812,0.0026517617812183663477,0.0029738645764074804478,0.0029831100698478659611,0.002690696863144849231,0.0023982836564418329346,0.0021058704497388162045,0.001813457243035800125,0.0015210440363327836118,0.0012286308296297670985,0.00093621762292675058531,0.0006438044162237341805,0.00035139120952071766727,5.8978002817701242132e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
			{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.00013514891775713350121,0.00040060915197875516863,0.00066606938620037694446,0.00093152962042199866609,0.0011969898546436204961,0.0014624500888652421093,0.0017279103230868639394,0.0019933705573084853357,0.0022588307915301073826,0.0025242910257517289958,0.002789751259973350609,0.0026509079539292434123,0.0024099163217538581601,0.0021689246895784724742,0.0019279330574030865714,0.0016869414252277006687,0.0014459497930523147659,0.00120495816087692908,0.00096396652870154328572,0.00072297489652615738297,0.00048198326435077164286,0.00024099163217538582143,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,}};    		
	final double[][] dct = new double[][]{    		
			{0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,0.28867513459481286553,},
			{0.73899979034524421184,0.72635529904298701265,0.70128266719036946863,0.66421089446983694327,0.61577428919087451309,0.55680161509896952676,0.48830191099814873601,0.41144722581728310207,0.32755256452796138733,0.23805338804483841542,0.14448105209140002514,0.048436605278962506504,-0.048436605278962256704,-0.14448105209139977534,-0.23805338804483816562,-0.32755256452796116529,-0.41144722581728271349,-0.48830191099814845845,-0.55680161509896941574,-0.61577428919087429104,-0.6642108944698366102,-0.70128266719036946863,-0.72635529904298701265,-0.73899979034524421184,},
			{1.1731728933695686479,1.0932230994463063567,0.93877195793237122601,0.7203450588793576248,0.45282783449021102307,0.15445114151393549151,-0.15445114151393507518,-0.45282783449021063449,-0.72034505887935729174,-0.93877195793237089294,-1.0932230994463063567,-1.1731728933695686479,-1.1731728933695688699,-1.0932230994463065787,-0.93877195793237144805,-0.72034505887935795787,-0.45282783449021163369,-0.15445114151393640745,0.1544511415139349364,0.4528278344902101904,0.7203450588793566256,0.93877195793237078192,1.0932230994463061347,1.1731728933695684258,},
			{1.5769016378304014925,1.3368326581196658953,0.89324302462843430117,0.3136652379057053297,-0.31366523790570510766,-0.89324302462843363504,-1.3368326581196661174,-1.5769016378304014925,-1.5769016378304014925,-1.3368326581196663394,-0.89324302462843419015,-0.3136652379057058293,0.31366523790570527419,0.89324302462843352401,1.3368326581196658953,1.5769016378304012704,1.5769016378304014925,1.3368326581196663394,0.89324302462843430117,0.31366523790570605135,-0.31366523790570366437,-0.89324302462843341299,-1.3368326581196658953,-1.5769016378304014925,},
			{1.9371065815609951333,1.4180604373787137895,0.51904614418228178785,-0.51904614418228101069,-1.4180604373787135675,-1.9371065815609946892,-1.9371065815609951333,-1.4180604373787144556,-0.51904614418228289807,0.51904614418228034456,1.4180604373787133454,1.9371065815609944671,1.9371065815609951333,1.4180604373787153438,0.51904614418228312012,-0.51904614418228023354,-1.4180604373787120132,-1.9371065815609940231,-1.9371065815609951333,-1.4180604373787155659,-0.51904614418228489647,0.51904614418228001149,1.4180604373787117911,1.9371065815609940231,},
			{2.2424605130248038698,1.3156665639340467955,-0.1548835866116687332,-1.5614213855233545214,-2.3226341570025756944,-2.123917747941666434,-1.0474003226641430686,0.46200065872623657937,1.7804598542985643483,2.3630668865981871996,1.9690341613299986445,0.76121277147922328243,-0.76121277147921584394,-1.9690341613299939816,-2.3630668865981871996,-1.7804598542985681231,-0.46200065872624218599,1.0474003226641377395,2.1239177479416642136,2.3226341570025761385,1.5614213855233602946,0.1548835866116754223,-1.3156665639340412444,-2.2424605130248020934,},
			{2.4838522902623632049,1.0288453055581445739,-1.0288453055581443518,-2.4838522902623632049,-2.483852290262363649,-1.0288453055581459061,1.028845305558145018,2.4838522902623627608,2.4838522902623632049,1.0288453055581461282,-1.0288453055581445739,-2.4838522902623627608,-2.4838522902623632049,-1.0288453055581465723,1.0288453055581443518,2.4838522902623627608,2.4838522902623632049,1.0288453055581467943,-1.0288453055581441298,-2.4838522902623627608,-2.4838522902623649813,-1.0288453055581472384,1.0288453055581439077,2.483852290262363649,},
			{2.6547557631691911517,0.57747006094283603872,-1.9516727641505633439,-2.9536762626662294018,-1.6444956008290987359,0.95146527874767539146,2.80292632631433003,2.4611615928788759255,0.19359417029031783519,-2.225456265371492659,-2.9031380428982398456,-1.3091806618371337745,1.3091806618371266691,2.9031380428982380693,2.2254562653714979881,-0.19359417029031000812,-2.4611615928788745933,-2.8029263263143309182,-0.95146527874768271893,1.6444956008290967375,2.9536762626662289577,1.9516727641505660085,-0.57747006094282637978,-2.6547557631691889313,},
			{2.75148798722492538,1.9454400192665258678e-16,-2.751487987224924936,-2.7514879872249258241,-5.8363200577995773569e-16,2.7514879872249244919,2.7514879872249267123,3.7945913330818749986e-15,-2.7514879872249227155,-2.7514879872249267123,-1.3618080134865680828e-15,2.7514879872249227155,2.7514879872249267123,7.3946386642370965969e-15,-2.7514879872249222714,-2.7514879872249271564,-7.7837266680904018198e-15,2.7514879872249191628,2.7514879872249271564,8.1728146719437070427e-15,-2.7514879872249191628,-2.7514879872249280446,-8.5619026757970122655e-15,2.7514879872249191628,},
			{2.7733457150567422111,-0.65071880031088524809,-3.2713843230716683763,-1.8530903623659380486,1.8530903623659367163,3.2713843230716683763,0.6507188003108872465,-2.7733457150567417671,-2.7733457150567430993,0.65071880031088191743,3.2713843230716683763,1.8530903623659389368,-1.8530903623659358281,-3.2713843230716692645,-0.65071880031089135432,2.7733457150567377703,2.7733457150567404348,-0.65071880031088658036,-3.2713843230716683763,-1.8530903623659398249,1.853090362365935162,3.2713843230716692645,0.65071880031089257557,-2.7733457150567373262,},
			{2.722614405526194048,-1.3132854842848793453,-3.4024209955054227628,-0.44793722190208568046,3.170551627428275232,2.0891355112205456379,-2.0891355112205367561,-3.1705516274282787847,0.44793722190207757583,3.4024209955054214305,1.3132854842848891153,-2.7226144055261882748,-2.7226144055262020416,1.3132854842848682431,3.4024209955054236509,0.44793722190209389611,-3.1705516274282725675,-2.0891355112205496347,2.0891355112205345357,3.1705516274282792288,-0.44793722190206336498,-3.4024209955054196541,-1.3132854842848964427,2.7226144055261833898,},
			{2.6044494914127840346,-1.9245517415256614413,-3.1068583125164117575,1.1134989709256979395,3.3975398739481668109,-0.22656308560119903239,-3.4566847076704672048,-0.67581269959381973234,3.2802621910065976607,1.5321329661448084281,-2.8802952269152051201,-2.2840409030224706477,2.2840409030224675391,2.8802952269152148901,-1.5321329661447986581,-3.280262191006598993,0.67581269959380319001,3.4566847076704676489,0.22656308560120674844,-3.3975398739481637023,-1.1134989709257079316,3.1068583125164077607,1.9245517415256758742,-2.6044494914127840346,},
			{2.426635158549948823,-2.4266351585499483789,-2.426635158549948823,2.4266351585499479349,2.426635158549948823,-2.4266351585499457144,-2.4266351585499470467,2.4266351585499452703,2.4266351585499474908,-2.4266351585499448262,-2.4266351585499479349,2.4266351585499448262,2.4266351585499483789,-2.4266351585499443821,-2.426635158549948823,2.4266351585499439381,2.426635158549948823,-2.4266351585499439381,-2.426635158549948823,2.426635158549943494,2.4266351585499581489,-2.426635158549943494,-2.4266351585499501553,2.4266351585499514876,},
			{2.1992311733251943551,-2.773345715056741323,-1.4752426615328919635,3.1584613294776668901,0.6507188003108902441,-3.3283330238988271255,0.21815047178863605781,3.2713843230716692645,-1.0721531497464666938,-2.9914961868453890936,1.8530903623659358281,2.5077425291667858609,-2.5077425291667743146,-1.8530903623659498169,2.9914961868453815441,1.0721531497464831251,-3.2713843230716661559,-0.21815047178865909494,3.3283330238988275696,-0.65071880031086160034,-3.1584613294776686665,1.4752426615328815274,2.7733457150567484284,-2.1992311733251828088,},
			{1.9341231235063127691,-2.9352989233795301338,-0.41470059462721836629,3.149963747189258978,-1.2158406236829459868,-2.5205983287523121561,2.5205983287523103797,1.2158406236829486513,-3.1499637471892580898,0.41470059462721287069,2.9352989233795323543,-1.9341231235063065519,-1.9341231235063196525,2.935298923379526137,0.41470059462722952404,-3.1499637471892603102,1.2158406236829435443,2.5205983287523143765,-2.5205983287523023861,-1.2158406236829510938,3.1499637471892558693,-0.41470059462721020616,-2.9352989233795385715,1.9341231235063045535,},
			{1.6444956008290994021,-2.9031380428982389574,0.57747006094283337418,2.4611615928788772578,-2.4611615928788714847,-0.57747006094284025757,2.9031380428982398456,-1.6444956008290925187,-1.6444956008291085059,2.903138042898236737,-0.57747006094282637978,-2.4611615928788799224,2.4611615928788705965,0.577470060942852359,-2.9031380428982420661,1.6444956008290865235,1.6444956008291100602,-2.903138042898236737,0.57747006094282460342,2.4611615928788803664,-2.4611615928788697083,-0.57747006094286446043,2.9031380428982442865,-1.6444956008290763094,},
			{1.3442511728291910433,-2.6885023456583816426,1.3442511728291888229,1.3442511728291923756,-2.6885023456583816426,1.3442511728291883788,1.344251172829194596,-2.6885023456583816426,1.3442511728291834938,1.3442511728291950401,-2.6885023456583816426,1.3442511728291830497,1.3442511728291959283,-2.6885023456583816426,1.3442511728291823836,1.3442511728291963724,-2.6885023456583816426,1.3442511728291737239,1.3442511728291970385,-2.6885023456583816426,1.3442511728291730577,1.3442511728291977047,-2.6885023456583816426,1.3442511728291726136,},
			{1.0474003226641412923,-2.3226341570025765826,1.7804598542985647924,0.15488358661167278552,-1.9690341613300004209,2.2424605130248025375,-0.76121277147921539985,-1.315666563934054345,2.3630668865981880877,-1.5614213855233487482,-0.4620006587262516784,2.1239177479416704308,-2.1239177479416606609,0.46200065872623030661,1.5614213855233711747,-2.3630668865981863114,1.3156665639340363594,0.76121277147922805639,-2.2424605130248114193,1.9690341613299884305,-0.15488358661165738117,-1.7804598542985818899,2.3226341570025721417,-1.0474003226641270814,},
			{0.76744877848097059481,-1.8527852494354242197,1.8527852494354235535,-0.76744877848097070583,-0.7674487784809720381,1.8527852494354239976,-1.8527852494354235535,0.76744877848097015072,0.76744877848097270423,-1.852785249435425774,1.8527852494354242197,-0.76744877848096948458,-0.76744877848097337036,1.8527852494354262181,-1.852785249435421111,0.76744877848096204609,0.76744877848096748618,-1.8527852494354235535,1.8527852494354239976,-0.76744877848096804129,-0.76744877848097481365,1.8527852494354266621,-1.852785249435420889,0.76744877848096071382,},
			{0.51680875460477049277,-1.3368326581196663394,1.6043525548545252146,-1.2088042586775624709,0.31366523790570349783,0.71110953022609291185,-1.4419874801413083976,1.5769016378304014925,-1.0600928832256264478,0.10515482202163914383,0.89324302462844007433,-1.5224694965832692439,1.5224694965832661353,-0.89324302462843219175,-0.1051548220216485946,1.0600928832256335532,-1.5769016378304030468,1.4419874801413039567,-0.71110953022608203167,-0.31366523790570993713,1.2088042586775704645,-1.6043525548545256587,1.336832658119659456,-0.51680875460476427552,}
	}; 


	double [] sample;  //f0
	double [] cepstrum;      //f1
	double [] fft;       //f3
	double [] energySpec;      //f4
	double bankPass[];
	double mfcc[];

	//for teo
	double [] pad;	
	double [] freq; 
	double [] freq1;
	double [] freq2;	
	double [] corr;


	DoubleFFT_1D fft_1;
	DoubleFFT_1D fft_2;

	public int getFrameIndex() {
		return frameIndex;
	}

	public int getFrame_length() {
		return frame_length;
	}

	public int getWindow_length() {
		return window_length;
	}

	public void setFrameIndex(int frameIndex) {
		this.frameIndex = frameIndex;
	}

	public int getFrame_feature_size() {
		return frame_feature_size;
	}

	public int getWindow_feature_size() {
		return window_feature_size;
	}

	public int zcr(short[] data){
		int result = 0;
		for(int i = 0; i< data.length -1; i++){
			result -= (data[i] ^ data[i+1])>>15;
		}
		return result;
	}

	public int zcr(double[] data){
		int result = 0;
		for(int i = 0; i< data.length -1; i++){
			if ((data[i]<0&&data[i+1]>0) || (data[i]>0&&data[i+1]<0)) result++;
		}
		return result;
	}

	public double rms(short[] a){
		double rms = 0;
		for (short x : a) {
			rms += x*x;
		}
		return Math.sqrt(rms/a.length);		
	}

	public double mean(double[] a){
		double sum = 0;
		for (double x : a) {
			sum += x;
		}
		return sum/a.length;
	}

	public double var(double[] a, double mean){
		double sum = 0;
		double tmp = 0;
		for (double x : a) {
			tmp = x - mean;
			sum += tmp * tmp;
		}
		return sum/(a.length-1);
	}

	public void var(ArrayList<Double> in, double[] out){
		double sum = 0;
		double mean;
		double tmp = 0;
		double min = Double.MAX_VALUE;
		double max = Double.MIN_VALUE;
		//Log.d(TAG, Arrays.toString(in.toArray()));
		for (double x : in) {
			sum += x;
			if(x > max) max = x;
			if(x < min) min = x;
		}
		out[0] = max - min;
		mean = sum/in.size();
		sum = 0;
		for (double x : in) {
			tmp = x - mean;
			sum += tmp * tmp;
		}
		out[1] = Math.sqrt(sum/(in.size()-1));
		return;
	}

	public void conv(short[] input, int inputLength, int[] bank_index,double[][] out)
	{
		int i, j, i1;
		double[] tmp = new double[bank_index.length];

		final int l  = (filter[0].length-1)/2;
		for (i=l; i<inputLength + l ; i++)
		{
			//Log.d(TAG, " " + i + " " + inputLength + " "  + l );
			i1 = i;
			Arrays.fill(tmp, 0);
			for (j=0; j<filter[0].length; j++)
			{
				if(i1>=0 && i1<inputLength){
					for(int k = 0; k < bank_index.length;k++)
						tmp[k] = tmp[k] + (input[i1]*filter[bank_index[k]-1][j]);
				}
				i1 = i1-1;
			}
			for(int k = 0; k < bank_index.length;k++)
				out[k][i-l] = tmp[k];
		}
	}


	public void teo(double[][] input,int inputLength,double[][]out){
		int i;
		int band = input.length;
		final int col = out[0].length/band;
		for(i = 1; i < input[0].length -1;i++ ){
			int frame = i/col;
			int offset = i%col;
			for(int j = 0; j < band; j++)
				//cat them together for JNI
				out[frame][j*col+offset] = input[j][i]*input[j][i] - input[j][i-1]*input[j][i+1];

		}
		for(int j = 0; j < band; j++){	
			out[0][j*col] = out[0][j*col+1];
			out[i/col][(j+1)*col-1] = out[i/col][(j+1)*col-2];
		}
	}


	public AudioFeatureExtraction(int frameLength, int windowLength, int mfccBank, int mfccLength,int sr){
		frameIndex = 0;
		frame_length = frameLength;
		fft_length = frameLength/2+1;
		window_length = windowLength;
		mfcc_length = mfccLength;
		mfcc_bank   = mfccBank;
		sample = new double[frame_length];
		cepstrum = new double[frame_length];
		freq = new double[frame_length*2];
		freq1 = new double[frame_length*2];
		freq2 = new double[frame_length*2];
		corr = new double[frame_length*2];
		pad = new double[frame_length*2];
		fft = new double[frame_length/2+1];
		energySpec = new double[frame_length/2+1];
		bankPass = new double[ mfcc_bank];
		mfcc = new double[mfcc_length];

		System.loadLibrary("stresstoolkit");
		//initMfcc(sr, mfccLength, sr/2, 0, fft_length);
		fft_1 = new DoubleFFT_1D(frameLength);
		fft_2 = new DoubleFFT_1D(frameLength*2);
		id = this.hashCode();
		initFFT(id);
	}

	@Override
	protected void finalize(){
		//delMfcc();
		delFFT(id);
	}

	public void test(double [] data){
		fft_1.realForward(data);
		fft_1.realInverse(data, true);
	}

	public  int getFrameFeatures(double [] data,double [] feature){
		if(feature.length < frame_feature_size){
			//throw exception
		}
		int result = getFrameFeature( data, hamming, frameIndex, frame_length, fft_length, mfcc_length, feature);
		return result;
	}

	public int getFrameFeat(double[] data,double[] feature){

		double sumfft = 0;
		double sumEnerySpec = 0;
		double pitch = 0;
		double specEntropy = 0;
		//double specFlux = 0;
		double specCentroid = 0;
		double hfr = 0;
		final int LOW_FREQ = 16;
		final int PITCH_MIN = 32;
		final int PITCH_MAX = 100;
		final int FS = 8000;

		for(int i=0;i<frame_length;i++) sample[i] = data[i]*hamming[i];

		//feature[0] = sqrt(rms/frame_length);
		//printf("rms %f,",rms_history[frameIndex % window_length]);
		//if(!cfg) initFFT();

		//kiss_fftr(cfg, sample, freq);
		fft_1.realForward(sample);
		//********************** discard dc, i start from 1 ********************************

		for(int i = 0;i<fft_length;i++){
			if(i == 0) energySpec[0] = sample[0]*sample[0];
			else if (i == fft_length-1) energySpec[i] = sample[1]*sample[1];
			else {
				double tmp1 = sample[i*2];
				double tmp2 = sample[i*2+1];
				energySpec[i] = tmp1*tmp1 + tmp2*tmp2;
			}

			fft[i] = Math.sqrt(energySpec[i]);
			if(fft[i] < 0.00000000000000000001){
				fft[i] = 0.00000000000000000001;
			}
			cepstrum[i] = Math.log(fft[i]);
			if (i>=1){
				sumfft += fft[i];
				sumEnerySpec += energySpec[i];
				cepstrum[ frame_length - i ] = cepstrum[i];
			}
		}



		double lowSum = 0;
		for(int i = 1; i<=LOW_FREQ; i++){
			lowSum += fft[i];
		}
		hfr = lowSum/(sumfft-lowSum);


		// kiss_fftr(cfg, cepstrum, freq);
		fft_1.realForward(cepstrum);
		{//pitch
			double max = 0;
			int ind = 0;
			for(int i = (PITCH_MIN - 1);i<PITCH_MAX;i++){
				//LOGD("r: %f", freq[i].r);
				//LOGD("i: %f", freq[i].i);
				double tmp = Math.abs(cepstrum[i*2]);
				if(tmp>max){				
					max = tmp;
					ind = i;
				}
			}
			//LOGD("max_r: %f", freq[ind].r);
			//LOGD("max_i: %f", freq[ind].i);
			//LOGD("i: %d", ind);
			pitch = FS/(double)(1 + ind);
		}

		/*
			 for(int i=0;i<fft_length;i++){
			 if(DEBUG) printf("%f,",energySpec[i]);
			 }
			 if(DEBUG) printf("\n");		
		 */
		//////////////////////////// mfcc calculation ////////////////////////////////////		
		//gettimeofday(&tv[2], NULL);
		//double* mf = calculateMfcc(energySpec);
		//mfcc calculation.
		for(int i = 0;i< mfcc_bank;i++){
			bankPass[i] = 0; 
			for(int j = filterInd[i][0]; j <=filterInd[i][1]; j++){
				bankPass[i] += fft[j-1] * bankFilter[i][j-1];				
			}
			bankPass[i] = Math.log10(bankPass[i]);
		}
		//actually we can start from i = 1
		for(int i = 0;i< mfcc_length;i++){
			mfcc[i] = 0; 
			for(int j = 0; j < mfcc_bank; j++){
				mfcc[i] += bankPass[j] * dct[i][j];				
			}
		}
		System.arraycopy(mfcc, 1, feature, 0, mfcc_length-1);
		//memcpy(feature,mfcc+1,sizeof(double)*(NMFCC-1));



		//memcpy(feature+6, mf, sizeof(double)*mfcc_length);
		//gettimeofday(&tv[3], NULL);
		/*
			 for(int i = 0;i<mfcc_length;i++){
			 printf("%f,",mf[i]);
			 }
			 printf("\n");
		 */
		//fft[],and spectralenenry[] are normalized
		///////////////////////////////////////////////////////////////////////////////////

		for(int i=1;i<fft_length;i++){
			fft[i] = fft[i]/sumfft;
			energySpec[i] = energySpec[i]/sumEnerySpec;
		}


		for(int i=1;i<fft_length;i++){
			specEntropy -= fft[i]*Math.log(fft[i]);
			specCentroid += i*energySpec[i];
		}

		feature[mfcc_length+2] = specEntropy;
		feature[mfcc_length+1] = pitch;
		feature[mfcc_length] = hfr;
		feature[mfcc_length-1] = specCentroid;

		if(feature[22]>4.2) return 0;
		return 1;
	}

	public void getTeo( double [] data, int numBank, int length, double [] out){
		int start;

		for(int i = 0; i< numBank; i++){		
			Arrays.fill(pad,256,512,0);
			start = i * frame_length;
			System.arraycopy(data, start, pad, 0, frame_length);
			fft_2.realForward(pad);
			pad[0]*=pad[0];
			pad[1]*=pad[1];
			for(int j = 1;j<frame_length;j++){
				int tmp = j*2;
				pad[tmp] = (pad[tmp]*pad[tmp]+pad[tmp+1]*pad[tmp+1]);
				pad[tmp+1] =0;
			}
			fft_2.realInverse(pad, true);
			if(pad[0]<1e-10) pad[0]=1e-10; 
			double temp = pad[0];
			for(int j = 0;j<frame_length;j++){
				pad[j] /= temp;
			}
			//hilbert
			//kiss_fftr(cfg,corr,freq0);
			fft_1.realForward(pad);
			pad[frame_length] = pad[1];
			pad[1] = 0;
			for(int j = 1; j<frame_length/2;j++){
				pad[j*2]*=2;
				pad[j*2+1]*=2;
			}
			Arrays.fill(pad,257,512,0);


			fft_1.complexInverse(pad, true);
			//kiss_fft(cfg_i,freq2,freq3);
			out[i] = 0;
			for(int j = 0;j<frame_length;j++){
				int tmp = 2*j;
				out[i] += Math.sqrt(pad[tmp]*pad[tmp]+pad[tmp+1]*pad[tmp+1]);
			}
			out[i]/=frame_length;
			//LOGD("out %d: %.20f", i,out[i]);	
		}
	}


	/*
	public  void getWindowFeatures(double [] feature){
		if(feature.length < window_feature_size){
			//throw exception
		}
		//Log.d(TAG, Arrays.toString(sf_history));
		//Log.d(TAG, Arrays.toString(se_history));
		//Log.d(TAG, Arrays.toString(sc_history));
		//Log.d(TAG, Arrays.toString(ro_history));
		//Log.d(TAG, Arrays.toString(bw_history));
		//Log.d(TAG, Arrays.toString(rms_history));		
		//getWindowFeature( this.window_length, this.frameIndex, this.mfcc_length, this.se_history, this.sf_history, this.sc_history, this.ro_history, this.bw_history, this.mfcc_history, this.rms_history, feature);
	}
	 */

	static public native void initMfcc(int sample_rate, int mell, int high_freq, int low_freq, int inputlen);
	static public native void delMfcc();

	static protected native int getFrameFeature( double [] data, double [] hanning,int frameIndex, int frame_length, int fft_length, int mfcc_length, double [] feature);

	static public native void getTeager( double [] data, int numBank, int length,double [] out);

	static public native float getEnrate(float[] data, int len, int sr);

	static protected native int initFFT(int id);

	static protected native int delFFT(int id);
}
